<h2 mat-dialog-title>Test Run</h2>

<!-- Show Spinner When Processing -->
<div *ngIf="isProcessing" style="text-align: center; margin-top: 20px;">
  <mat-progress-spinner
    mode="indeterminate"
    diameter="50"
    color="primary"
  ></mat-progress-spinner>
  <p>Processing your code... This might take a few seconds to minutes.</p>
</div>

<!-- Show Error Message -->
<div *ngIf="!isProcessing && errorMessage" style="color: red; text-align: center; margin-top: 10px;">
  {{ errorMessage }}
</div>

<!-- Hide Form When Processing -->
<div *ngIf="!isProcessing && !errorMessage">
  <form [formGroup]="form">
    <div class="form-group">
      <label for="file">Upload File:</label>
      <input
        type="file"
        id="file"
        (change)="onFileSelected($event)"
        accept=".zip"
      />
      <p *ngIf="fileError" style="color: red;">File must be named 'src.zip'</p>
    </div>
    <button mat-raised-button color="primary" (click)="onSubmit()">
      Submit
    </button>
  </form>
</div>

<!-- Display Results -->
<div *ngIf="results.length">
  <h3>Test Results</h3>
  <table>
    <thead>
      <tr>
        <th>Test Case</th>
        <th>Status</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let result of results">
        <td>{{ result.testCase }}</td>
        <td [style.color]="result.status === 'PASSED' ? 'green' : 'red'">
          {{ result.status }}
        </td>
      </tr>
    </tbody>
  </table>
  <p style="margin-top: 10px; font-weight: bold;">
    Total Passed: {{ score }}
  </p>
</div>

<div mat-dialog-actions>
  <button mat-button (click)="onClose()">Close</button>
</div>